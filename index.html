<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Castle Douglas Soapbox Derby</title>
    <link href="https://fonts.googleapis.com/css?family=Montserrat:700,400|Fredoka+One&display=swap" rel="stylesheet">
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#dc2626', // red-600
                        secondary: '#1d4ed8', // blue-700
                        accent: '#16a34a', // green-600
                    },
                    fontFamily: {
                        'fredoka': ['"Fredoka One"', 'cursive'],
                        'sans': ['Montserrat', 'sans-serif'],
                    }
                }
            }
        }
    </script>
</head>
<body class="font-sans bg-white text-gray-900">
    <nav class="bg-primary text-white sticky top-0 z-50 shadow-md">
        <div class="container mx-auto px-4 py-3 flex flex-col md:flex-row justify-between items-center">
            <div class="font-fredoka text-2xl mb-2 md:mb-0">üèÅ Soapbox Derby</div>
            <ul class="flex flex-col md:flex-row space-y-2 md:space-y-0 md:space-x-6 items-center">
                <li><a href="#home" class="font-bold hover:text-yellow-300 transition-colors">Home</a></li>
                <li><a href="#event-info" class="font-bold hover:text-yellow-300 transition-colors">Event Info</a></li>
                <li><a href="#join" class="font-bold hover:text-yellow-300 transition-colors">Join the Race</a></li>
                <li><a href="#spectators" class="font-bold hover:text-yellow-300 transition-colors">Spectator Info</a></li>
                <li><a href="#gallery" class="font-bold hover:text-yellow-300 transition-colors">Gallery</a></li>
                <li><a href="#sponsors" class="font-bold hover:text-yellow-300 transition-colors">Sponsors</a></li>
                <li><a href="#contact" class="font-bold hover:text-yellow-300 transition-colors">Get in Touch</a></li>
            </ul>
        </div>
    </nav>

    <section id="home" class="bg-gradient-to-r from-primary to-secondary text-white text-center py-16 px-4">
        <h1 class="text-4xl md:text-5xl font-bold mb-4">Race Day Returns to Castle Douglas ‚Äì Join the Soapbox Fun!</h1>
        <div id="countdown-timer" class="text-2xl md:text-3xl font-bold my-4 bg-white text-primary px-6 py-2 rounded-full inline-block shadow-lg"></div>
        <p class="text-xl max-w-3xl mx-auto my-6">
            A free, family-friendly event celebrating creativity, community, and fun in the heart of Castle Douglas. All ages welcome‚Äîspectate or race!
        </p>
        <div class="mt-8 flex justify-center">
            <svg width="120" height="60" class="opacity-80">
                <ellipse cx="60" cy="30" rx="55" ry="25" fill="#FFFFFF" opacity="0.7"/>
                <ellipse cx="60" cy="30" rx="35" ry="15" fill="#16a34a" opacity="0.5"/>
            </svg>
        </div>
    </section>

    <section id="event-info" class="py-12 px-4">
        <div class="max-w-4xl mx-auto">
            <h2 class="text-3xl font-bold text-secondary mb-6">Event Info</h2>
            <div class="bg-gray-50 border-l-4 border-accent p-4 rounded-r-lg mb-6 shadow">
                <div class="mb-2">
                    <strong>Date:</strong> Saturday, 10th August 2024
                </div>
                <div class="mb-2">
                    <strong>Time:</strong> 11:00 AM ‚Äì 4:00 PM
                </div>
                <div class="mb-2">
                    <strong>Location:</strong> King Street, Castle Douglas, DG7 1DT
                </div>
                <div class="mb-2">
                    <strong>Race Route:</strong> Down the iconic King Street, featuring twists, turns, and a thrilling finish line in the town centre. Safety barriers and marshals throughout.
                </div>
                <div class="mb-2">
                    <strong>Safety:</strong> All racers must wear helmets. No engines allowed‚Äîgravity only! Cars must pass a safety check before racing.
                </div>
                <div>
                    <span class="bg-accent text-white font-bold px-3 py-1 rounded-full text-sm">FREE TO ENTER!</span>
                </div>
            </div>
            <div id="pdf-links" class="mt-6">
                <!-- PDF download links will be loaded here by JS -->
            </div>
        </div>
    </section>

    <section id="join" class="py-12 px-4 bg-gray-50">
        <div class="max-w-4xl mx-auto">
            <h2 class="text-3xl font-bold text-secondary mb-6">Join the Race</h2>
            <ul class="space-y-2 list-disc pl-5">
                <li>Build your own soapbox car (no engines, must have brakes and steering).</li>
                <li>Teams: 2‚Äì5 people, ages 8+ (under 16s must have an adult on the team).</li>
                <li>All drivers must wear a helmet and closed-toe shoes.</li>
                <li>Download the rules and entry form below.</li>
                <li>Submit your entry to: <a href="mailto:info@castle-douglas-soapbox.co.uk" class="text-primary hover:underline">info@castle-douglas-soapbox.co.uk</a></li>
                <li><strong>No entry fee!</strong></li>
            </ul>
        </div>
    </section>

    <section id="spectators" class="py-12 px-4">
        <div class="max-w-4xl mx-auto">
            <h2 class="text-3xl font-bold text-secondary mb-6">Spectator Info</h2>
            <ul class="space-y-2 list-disc pl-5">
                <li>Best viewing: Along King Street, especially near the finish line.</li>
                <li>Parking: Free parking at Market Hill and Lochside car parks.</li>
                <li>Facilities: Toilets, accessible viewing, and first aid available.</li>
                <li>Family fun: Food stalls, live music, and kids' activities all day!</li>
                <li>Schedule: 11:00 AM ‚Äì Opening, 12:00 PM ‚Äì First race, 3:30 PM ‚Äì Awards.</li>
            </ul>
        </div>
    </section>

    <section id="gallery" class="py-12 px-4 bg-gray-50">
        <div class="max-w-6xl mx-auto">
            <h2 class="text-3xl font-bold text-secondary mb-6 text-center">Gallery</h2>
            <div class="gallery-grid grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4">
                <!-- Images will be loaded here by JS -->
            </div>
        </div>
    </section>

    <section id="sponsors" class="py-12 px-4">
        <div class="max-w-4xl mx-auto text-center">
            <h2 class="text-3xl font-bold text-secondary mb-6">Sponsors & Supporters</h2>
            <p class="mb-6">Huge thanks to our amazing sponsors and volunteers!</p>
            <div class="flex flex-wrap justify-center items-center gap-8">
                <!-- Sponsor logos will go here -->
            </div>
        </div>
    </section>

    <section id="contact" class="py-12 px-4 bg-gray-50">
        <div class="max-w-4xl mx-auto text-center">
            <h2 class="text-3xl font-bold text-secondary mb-6">Get in Touch</h2>
            <p class="mb-6">Questions? Want to volunteer or sponsor? Email us at <a href="mailto:info@castle-douglas-soapbox.co.uk" class="text-primary hover:underline">info@castle-douglas-soapbox.co.uk</a></p>
            <div class="flex justify-center gap-6">
                <a href="https://facebook.com/soapboxderbycd" target="_blank" class="text-primary hover:text-secondary transition-colors">Facebook</a>
                <a href="https://instagram.com/soapboxderbycd" target="_blank" class="text-primary hover:text-secondary transition-colors">Instagram</a>
                <a href="https://twitter.com/soapboxderbycd" target="_blank" class="text-primary hover:text-secondary transition-colors">Twitter</a>
            </div>
        </div>
    </section>

    <footer class="bg-gray-900 text-white py-4 px-4 text-center">
        <p>&copy; 2024 Castle Douglas Soapbox Derby. All rights reserved.</p>
    </footer>

    <!-- Supabase JS Client -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <!-- Countdown Timer -->
    <script src="countdown.js"></script>
    <!-- Supabase Gallery and PDF Loader -->
    <script>
        // Supabase config
        const SUPABASE_URL = 'https://db.noguwwpdkldfluxbffof.supabase.co';
        const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im5vZ3V3d3Bka2xkZmx1eGJmZm9mIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDY3MzcxNzAsImV4cCI6MjA2MjMxMzE3MH0.icLJ_F_lLo-15mpdWw7XrMW8hzlAGfHfDNBlwhkITcY';

        const supabase = supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

        // Fetch and display gallery images
        async function loadGallery() {
            const { data, error } = await supabase.storage.from('gallery').list('', { limit: 100 });
            if (error) {
                console.error('Error loading gallery:', error);
                // Show placeholder images if Supabase fails
                addPlaceholderImages();
                return;
            }
            
            const galleryDiv = document.querySelector('.gallery-grid');
            galleryDiv.innerHTML = '';
            
            if (!data || data.length === 0) {
                // No images found, show placeholders
                addPlaceholderImages();
                return;
            }
            
            for (const file of data) {
                if (file.name.match(/\.(jpg|jpeg|png|gif)$/i)) {
                    const { data: urlData } = supabase.storage.from('gallery').getPublicUrl(file.name);
                    const img = document.createElement('img');
                    img.src = urlData.publicUrl;
                    img.alt = file.name;
                    img.className = 'w-full h-48 object-cover rounded-lg border-2 border-primary hover:scale-105 transition-transform duration-300';
                    
                    const div = document.createElement('div');
                    div.className = 'overflow-hidden rounded-lg shadow-md';
                    div.appendChild(img);
                    
                    galleryDiv.appendChild(div);
                }
            }
        }
        
        // Add placeholder images if Supabase fails or returns no images
        function addPlaceholderImages() {
            const galleryDiv = document.querySelector('.gallery-grid');
            const placeholders = [
                'https://images.unsplash.com/photo-1535813547-99c456a4cc6a?ixlib=rb-1.2.1&auto=format&fit=crop&w=800&q=80',
                'https://images.unsplash.com/photo-1541625602330-2277a4c46182?ixlib=rb-1.2.1&auto=format&fit=crop&w=800&q=80',
                'https://images.unsplash.com/photo-1562277345-c6b2c7b26911?ixlib=rb-1.2.1&auto=format&fit=crop&w=800&q=80',
                'https://images.unsplash.com/photo-1522598140461-d03a4a827c59?ixlib=rb-1.2.1&auto=format&fit=crop&w=800&q=80',
                'https://images.unsplash.com/photo-1526142437629-e18f8736ab61?ixlib=rb-1.2.1&auto=format&fit=crop&w=800&q=80',
                'https://images.unsplash.com/photo-1520340356584-f9917d1eea6f?ixlib=rb-1.2.1&auto=format&fit=crop&w=800&q=80',
                'https://images.unsplash.com/photo-1481555716071-8830d3e254ba?ixlib=rb-1.2.1&auto=format&fit=crop&w=800&q=80',
                'https://images.unsplash.com/photo-1558857563-e5f5f2e682c6?ixlib=rb-1.2.1&auto=format&fit=crop&w=800&q=80'
            ];
            
            for (const url of placeholders) {
                const img = document.createElement('img');
                img.src = url;
                img.alt = 'Racing event';
                img.className = 'w-full h-48 object-cover rounded-lg border-2 border-primary hover:scale-105 transition-transform duration-300';
                
                const div = document.createElement('div');
                div.className = 'overflow-hidden rounded-lg shadow-md';
                div.appendChild(img);
                
                galleryDiv.appendChild(div);
            }
        }

        // Fetch and display PDF links
        async function loadPDFs() {
            const { data, error } = await supabase.storage.from('docs').list('', { limit: 10 });
            if (error) {
                console.error('Error loading PDFs:', error);
                addPlaceholderPDFs();
                return;
            }
            
            const pdfSection = document.getElementById('pdf-links');
            pdfSection.innerHTML = '';
            
            if (!data || data.length === 0) {
                addPlaceholderPDFs();
                return;
            }
            
            for (const file of data) {
                if (file.name.match(/\.pdf$/i)) {
                    const { data: urlData } = supabase.storage.from('docs').getPublicUrl(file.name);
                    const a = document.createElement('a');
                    a.href = urlData.publicUrl;
                    a.textContent = file.name.replace(/_/g, ' ');
                    a.className = 'inline-block bg-secondary hover:bg-blue-800 text-white font-bold py-2 px-4 rounded-full mr-2 mb-2 transition-colors';
                    a.target = '_blank';
                    pdfSection.appendChild(a);
                }
            }
        }
        
        // Add placeholder PDFs if Supabase fails
        function addPlaceholderPDFs() {
            const pdfSection = document.getElementById('pdf-links');
            
            const placeholders = [
                { name: 'Soapbox Derby Rules.pdf', url: '#' },
                { name: 'Entry Form.pdf', url: '#' }
            ];
            
            for (const pdf of placeholders) {
                const a = document.createElement('a');
                a.href = pdf.url;
                a.textContent = pdf.name;
                a.className = 'inline-block bg-secondary hover:bg-blue-800 text-white font-bold py-2 px-4 rounded-full mr-2 mb-2 transition-colors';
                pdfSection.appendChild(a);
            }
        }

        document.addEventListener('DOMContentLoaded', () => {
            loadGallery();
            loadPDFs();
        });
    </script>
</body>
</html> 